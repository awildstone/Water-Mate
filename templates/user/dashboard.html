{% extends 'base.html'  %}

{% block title %} Dashboard {% endblock %}

{% block content %}

<h1>Dashboard</h1>
<p>Welcome to the dashboard, {{ user.name }}!</p>
<p><a href="{{ url_for('add_collection') }}" class="btn btn-success">Add a Collection</a></p>

{% if collections %}

  {% for collection in collections %}
    <div class="card col bg-light m-4">
      <h2 class="m-3" style="display: inline;">{{ collection.name }} Collection</h2>
    <div class="col">
      <a href="{{ url_for('add_room', collection_id=collection.id) }}" class="card-link btn btn-success">Add Room</a>
      <a href="{{ url_for('edit_collection', collection_id=collection.id) }}" class="card-link btn btn-warning m-2">Edit {{ collection.name }}</a>
      <form method="POST" action="{{ url_for('delete_collection', collection_id=collection.id)}}" style="display: inline;"><button class="btn btn-danger m-2">Delete {{ collection.name }}</button></form>
    </div>

    <div class="row text-left">
    {% for room in collection.rooms %}
      <div class="col">
        <div class="card mx-auto m-2" style="width: 18rem;">
          <div class="card-body">
            <h4 class="card-title"><a href="{{ url_for('view_room', room_id=room.id) }}">{{ room.name }}</a></h4>
            <p>Visit {{ room.name }} to edit room details, or add new lightsources and plants.</p>
            <a href="{{ url_for('view_room', room_id=room.id) }}" class="card-link btn btn-info btn-sm">Visit</a>
            <a href="{{ url_for('edit_room', room_id=room.id) }}" class="card-link btn btn-warning btn-sm">Edit</a>
            <form method="POST" action="{{ url_for('delete_room', room_id=room.id) }}" class="card-link" style="display: inline;"><button class="btn btn-danger btn-sm">Delete</button></form>
          </div>
          <div class="card-body list-group-item-secondary">
            <h5>Light Sources</h5>
            <p>View plants using this lightsource.</p>
            {% for light in room.lightsources %}
              <a href="{{ url_for('view_lightsource_plants', lightsource_id=light.id)}}" class="card-link">{{ light.type }}</a>
            {% endfor %}
          </div>
          <div class="card-body list-group-item-success">
            <h5>Plants</h5>
            <p>View plant details.</p>
            <ul class="list-group list-group-flush">
            {% for plant in room.plants %}
              <li class="list-group-item list-group-item-success"><a href="{{ url_for('view_plant', plant_id=plant.id) }}">{{ plant.name }}</a></li>
            {% endfor %}
            </ul>
          </div>
        </div>
      </div>
    {% endfor %}
    </div>

  </div>
  {% endfor %}

{% else %}
<h4>You don't have any collections yet! Add your first collection.</h4>
{% endif %}
 
{% endblock %}